<p><em>* For the interim, vosbox is currently closed-source due to a business deal</em>*</p>

<p><strong>vosbox is a HTML5 PHP/jQuery based jukebox.</strong></p>

<p><img src="http://callanbryant.co.uk/images/vosbox.png" alt="Screenshot of vosbox" title=""></p>

<p>It supports</p>

<ul>
<li>A search-oriented interface</li>
<li>Making and sharing playlists (via a link)</li>
<li>Album art</li>
<li>Watching a directory for new music</li>
<li>A tag-based index</li>
<li>Keyboard shortcuts</li>
<li>A simple interface and API</li>
<li>Flat file and sqlite backends (documentation for that coming soon)</li>
<li>Flash fallback via SoundManager2 library</li>
</ul>

<p>Given an arbitrary mess of MP3s in any directory structure, vosbox will
find all MP3s, prefering high-quality files.</p>

<p>Album art will be extracted and resized using the <imagemagick.org> library
from the MP3 file with the fantastic <a href="http://GetID3.org/">http://GetID3.org/</a> library, or loaded from
the containing folder.</imagemagick.org></p>

<p>vosbox currently supports sqlite or file based backends, with support
for any other database easy to implement.</p>

<p>A native android app that uses the API is planned.</p>

<hr>

<h1 id="dependencies">Dependencies</h1>

<ul>
<li>php-imagick</li>
<li>The php JSON extension</li>
<li>inotify-tools (if you want to watch a directory)</li>
</ul>

<h1 id="usage">Usage</h1>

<ol>
<li>Serve <code>www/</code> with Apache and PHP</li>
<li>Crawl any directory (read permissions required) with
 <code>cli/crawl.sh &lt;directory&gt;</code></li>
<li>Watch that directory, if required, for new songs with
 <code>cli/watch.sh &lt;directory&gt;</code></li>
</ol>

<h1 id="keyboardshortcuts">Keyboard shortcuts</h1>

<pre><code>f       : search
up/down : prev/next
d       : download active song
space   : pause/play
s       : shuffle
</code></pre>

<h1 id="mousefunctions">Mouse functions</h1>

<p>Search results: Left click to play, right click to enqueue.</p>

<p>Playlist: Left click to play, right click to delete</p>

<h1 id="jsonapi">JSON API</h1>

<p>Songs are returned as the following JSON-formatted objects:</p>

<pre><code>{
    title      : "The song name",
    artist     : "The artist name",
    album      : "The album name",
    year       : "2009",
    genre      : "Indie",
    id         : "74a12d502d7393e139e2fcca51200d67",
    albumArtId : "b092c997d98e13a21431c9ce58b80fbf"
}
</code></pre>

<ul>
<li><p>To search for anything, POST or GET it as the parameter <strong>keywords</strong> to</p>

<p>api/search.php?keywords=</p></li>
<li><p>To save a playlist, POST a CSV list of IDs as the parameter <strong>save</strong></p>

<p>api/playlist.php?save=</p></li>
<li><p>To load a playlist, POST or GET the playlist ID as the parameter <strong>load</strong></p>

<p>api/playlist.php?load=</p></li>
<li><p>To download album art, POST or GET the albumArt ID, given in the song object,
using the parameter <strong>id</strong> (the result is a 128x128 JPG):</p>

<p>api/albumArt.php?id=</p></li>
<li><p>To download the song itself (currently MP3 only) POST or GET the song ID, as
the parameter <strong>id</strong> to:</p>

<p>api/download.php?id=</p></li>
</ul>

<hr>

<h1 id="thevosboxsearchenginevse">The vosbox search engine (VSE)</h1>

<p>The search engine that powers vosbox is very different to a standard fulltext search engine.</p>

<p>How it indexes:</p>

<ol>
<li>A PHP object per item, with descriptive attributes is added</li>
<li>This object is scraped for unique lower-case alphanumeric keywords (using the tokeniser)</li>
<li>The object is stored under an ID (specified or created automatically)</li>
<li>Per keyword, the ID is associated in a reverse-map list</li>
</ol>

<p>How it searches:</p>

<ol>
<li>The search string is tokenised in the same manner</li>
<li>For each keyword, the corresponding list of IDs is intersected with the last (by the backend)</li>
<li>The resulting intersection of IDs is used to return a set number of corresponding objects</li>
</ol>

<p>This can be acheived with, currently, a file based or sqlite based backend.</p>

<p>The idea is that avoiding fulltext search queries with multiple wildcards results in a speed
increase.</p>

<h1 id="configuration">Configuration</h1>

<p>In order to choose a different indexer, simply create <code>var/config.php</code> and define the constant
<code>INDEXER</code> to be either <code>sqlite</code> or <code>keystore</code>. Redis is also planned, and will involve defining
some more constants.</p>

<hr>

<p>Vosbox uses the following excellent libraries:</p>

<ul>
<li><a href="http://jquery.com">jQuery</a></li>
<li><a href="http://code.google.com/p/js-hotkeys/">js-hotkeys plugin</a></li>
<li><a href="http://abeautifulsite.net/blog/2008/05/jquery-right-click-plugin/">jQuery rightClick plugin</a></li>
<li><a href="http://www.yelotofu.com/2008/08/jquery-shuffle-plugin/">jQuery shuffle plugin</a></li>
<li><a href="https://github.com/michenriksen/css3buttons">css3buttons by Micheal Henriksen</a></li>
<li><a href="http://getid3.org/">getID3</a></li>
<li><a href="http://www.schillmania.com/projects/soundmanager2/">SoundManager2</a></li>
</ul>

<hr>

